5
S A B C D
5
S->a|bA|B|ccD
A->abB|epsilon
B->aA
C->ddC
D->ddd

output:

S->a|bA|aA|ccD|b
A->abB
B->aA|a
D->ddd

--- 

6
S A B C D E
6
S -> A | B | C
A -> Bd | Cf | D | c
C -> A | E
B -> bB
D -> dD 
E -> eE

--- for useless symbol

9
S A P B C D E F G
9
S -> a | E | F | bA | B | ccD | Pc
A -> abB | epsilon | P | F
P -> ppP | A | C | E | G
B -> aA
C -> ddC | D
D -> ddd
E -> eE | F
F -> fF | G
G -> gG


--- for epsilon case
7
S A B X Y C D
7
S -> XYX | A | B
A -> bBX | aCbC
B -> bbb | BX | D
D -> C
X -> aX | epsilon
Y -> bY | epsilon
C -> epsilon

remove epsilon output:

S -> XYX | XY | YX | XX | X | Y | A | B
A -> bBX | bB | aCbC | abC | aCb | ab
B -> bbb | BX | B | D
D -> C
X -> aX | a
Y -> bY | b


remove useless another time:

S -> XYX | XY | YX | XX | X | Y | A | B
A -> bBX | bB | aCbC | abC | aCb | ab
B -> bbb | BX | B
X -> aX | a
Y -> bY | b


--- for remove unit:
3
S A B
3
S -> A
A -> B | bS | a    
B -> AB | epsilon

remove useless and epsilon:

A -> B a bS
B -> A AB
S -> A

remove unit:

A -> AB | a | bS
B -> AB | a | bS
S -> AB | a | bS
